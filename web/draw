<!DOCTYPE html>
<html>
<head>
<!-- Load the Paper.js library -->
<script type="text/javascript" src="js/paper-full.js"></script>
<script src=''></script>
<!-- Define inlined JavaScript -->

</head>
<body>
	<!-- <div style="width 100%;height:100vh;"> -->
	<canvas id="myCanvas" style="position: relative; width:100%; height:97vh" resize></canvas>
<!-- </div> -->
</body>
<footer>
	<script type="text/javascript">

canvas = document.getElementById("myCanvas");
canvas.style.height = window.innerheight;
paper.install(window);

//toggle pen
	//space
	//TODO:double tap

//change color
	//TODO:tap and hold
	//TODO:XY axis color picker

//change opacity & width 
	//TODO:double tap and hold
	//TODO:XY opacity and width picker

//toggle typing mode with (alt)

//clear project (del)
//change colors rgb with keys (r,g,b)
//change pen size with keys (1,2,3)
//change pen opacity with keys (7,8,9)

//add text to annotation

//annotations per page

//shared annotations

//interactive annotations

var pen = false;

window.onload = function() {
	var penColor = 'black';
	var penWidth = 1;
	var penOpacity = 0.5;
	paper.setup('myCanvas');
	var penTool = new Tool();
	var path;
	var typing = false;
	var buffer = 'tjena';
	var text = new PointText(new Point(20,20));
	text.fillColor = 'black';
	text.content = buffer;
	
	setPenColor = function(c) {
		penColor=c;
	}
	setPenWidth = function(w) {
		penWidth=w;
	}
	setPenOpacity = function(o) {
		penOpacity = o;
	}

	penTool.onMouseDown = function(event) {
		if(pen) {
			path = new Path();
			path.strokeColor = penColor;
			path.strokeWidth = penWidth;
			path.strokeColor.alpha = penOpacity;	
			path.add(event.point);
		}
	}
	penTool.onKeyDown = function(event) {
		if(typing) {
			if(event.key == 'alt') {
				console.log('alt');
				typing = !typing;
			} else if(event.key == 'backspace') {
				text.content = text.content.substring(0,text.content.length - 1);
			}
			else {
				text.content += event.character;
				console.log(text.content);
			}
		}
		else {
			if(event.key == 'alt') {
				console.log('alt');
				typing = !typing;
			}
			if(event.key == 'space') {
				pen = !pen;
			}
			else if(event.key == 'r'){
				setPenColor('#ff0000');
			}
			else if(event.key == 'g') {
				setPenColor('#00ff00');
			}
			else if(event.key == 'b') {
				setPenColor('#0000ff');
			}
			else if(event.key == '1') {
				setPenWidth(1);
			}
			else if(event.key == '2') {
				setPenWidth(7);
			}
			else if(event.key == '3') {
				setPenWidth(17);
			}
			else if(event.key == '7') {
				setPenOpacity(0.1);
			}
			else if(event.key == '8') {
				setPenOpacity(0.4);
			}
			else if(event.key == '9') {
				setPenOpacity(1);
			}
			else if(event.key == 'delete'){
				paper.project.clear();
			}
		}
	}
	penTool.onMouseDrag = function(event) {
		if(pen) {
			path.add(event.point);
		}
	}
	penTool.onMouseUp = function(event) {
		if(pen) {
			path.smooth({type: 'catmull-rom', factor: 0});
		}
	}
}
	</script>
</footer>
</html>
